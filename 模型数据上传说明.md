# æ¨¡å‹æ•°æ®ä¸Šä¼ è¯´æ˜

## ğŸ“ ç›¸å…³æ–‡ä»¶ä½ç½®

### 1. **è®­ç»ƒæ ‡è®°ï¼ˆTrue/Falseï¼‰**
**æ–‡ä»¶è·¯å¾„ï¼š** `app/src/main/kotlin/com/aisleron/ui/product/RecommendationDialogTracker.kt`

- **å…³é”®æ–¹æ³•ï¼š** `getLastRetrainDecision()` (ç¬¬114è¡Œ)
- **è¿”å›å€¼ï¼š** `Boolean` ç±»å‹
  - `true` = éœ€è¦é‡æ–°è®­ç»ƒæ¨¡å‹
  - `false` = ä¿æŒå½“å‰æ¨¡å‹ï¼Œä¸éœ€è¦é‡æ–°è®­ç»ƒ

- **åˆ¤æ–­é€»è¾‘ï¼š** åœ¨ `onDialogDismissed()` æ–¹æ³•ä¸­è®¡ç®—ï¼ˆç¬¬54-108è¡Œï¼‰
  - å¦‚æœç”¨æˆ·æ·»åŠ çš„äº§å“æ•°é‡ < 1ï¼Œè¿”å› `true`
  - å¦‚æœå¯¹è¯æ¡†æ˜¾ç¤ºæ—¶é—´ < 5ç§’ ä¸” æ·»åŠ ç‡ <= 33%ï¼Œè¿”å› `true` ï¼ˆå³è¢«å¿«é€Ÿå†³å®šï¼‰
  - å…¶ä»–æƒ…å†µè¿”å› `false`

### 2. **Purchase Set æ•°æ®ï¼ˆè´­ä¹°é›†åˆæ•°æ®ï¼‰**
**æ–‡ä»¶è·¯å¾„ï¼š** `app/src/main/kotlin/com/aisleron/domain/product/ModelTrainingDataUploader.kt`

- **å…³é”®æ–¹æ³•ï¼š** `uploadPurchaseSets()` (ç¬¬39è¡Œ)
- **æ•°æ®æ¥æºï¼š** `PurchaseSet` å¯¹è±¡åˆ—è¡¨
- **æ•°æ®å®šä¹‰ï¼š** `app/src/main/kotlin/com/aisleron/domain/product/PurchaseSet.kt`

## ğŸ“¤ éœ€è¦ä¸Šä¼ çš„æ•°æ®æ ¼å¼

### è®­ç»ƒæ ‡è®°æ ¼å¼
```json
{
  "should_retrain": true  // æˆ– false
}
```

### Purchase Set æ•°æ®æ ¼å¼

æ¯ä¸ª Purchase Set ä»£è¡¨ç”¨æˆ·åœ¨2å°æ—¶å†…ä¸€èµ·è´­ä¹°çš„äº§å“é›†åˆã€‚

**å•ä¸ª Purchase Set çš„æ•°æ®ç»“æ„ï¼š**
```json
{
  "id": 1,
  "productIds": [101, 102, 103],  // äº§å“IDé›†åˆï¼ˆæ•´æ•°æ•°ç»„ï¼‰
  "productNames": ["äº§å“1", "äº§å“2", "äº§å“3"],  // äº§å“åç§°æ•°ç»„ï¼ˆå¯é€‰ï¼Œç”¨äºè°ƒè¯•ï¼‰
  "startTime": "2025-01-15T10:00:00Z",  // 2å°æ—¶æ—¶é—´çª—å£å¼€å§‹æ—¶é—´ï¼ˆISO 8601æ ¼å¼ï¼‰
  "endTime": "2025-01-15T12:00:00Z",    // 2å°æ—¶æ—¶é—´çª—å£ç»“æŸæ—¶é—´ï¼ˆISO 8601æ ¼å¼ï¼‰
  "collectedAt": "2025-01-15T14:30:00Z" // æ•°æ®æ”¶é›†æ—¶é—´ï¼ˆISO 8601æ ¼å¼ï¼‰
}
```

## ğŸ“ æ•°æ®æ ¼å¼è¯´æ˜

1. **productIds**: æ•´æ•°æ•°ç»„ï¼Œè¡¨ç¤ºåœ¨2å°æ—¶å†…ä¸€èµ·è´­ä¹°çš„äº§å“ID
2. **æ—¶é—´çª—å£**: æ¯ä¸ª purchase set ä»£è¡¨ç”¨æˆ·åœ¨ `startTime` åˆ° `endTime` ä¹‹é—´ï¼ˆ2å°æ—¶å†…ï¼‰è´­ä¹°çš„äº§å“ç»„åˆ
3. **æ•°æ®å»é‡**: ç³»ç»Ÿä¼šè‡ªåŠ¨å»é‡ï¼Œç›¸åŒçš„äº§å“ç»„åˆå’Œæ—¶é—´çª—å£ä¸ä¼šé‡å¤ä¸Šä¼ 
4. **ä¸Šä¼ æ—¶æœº**: åªæœ‰å½“ `should_retrain = true` æ—¶ï¼Œæ‰ä¼šæ”¶é›†å¹¶ä¸Šä¼  purchase sets

## ğŸ” ä»£ç ä¸­çš„æ ¼å¼åŒ–ç¤ºä¾‹

åœ¨ `ModelTrainingDataUploader.kt` ç¬¬51è¡Œï¼Œå¯ä»¥çœ‹åˆ°æ•°æ®è¢«æ ¼å¼åŒ–ä¸ºï¼š
```
['Product1', 'Product2', 'Product3']
```

ä½†å®é™…APIä¸Šä¼ æ—¶ï¼Œå»ºè®®ä½¿ç”¨ JSON æ ¼å¼ï¼ŒåŒ…å« `productIds` æ•°ç»„å’Œæ—¶é—´æˆ³ã€‚

## âš ï¸ æ³¨æ„äº‹é¡¹
- å½“å‰å®ç°æ˜¯å ä½ç¬¦ï¼ˆplaceholderï¼‰ï¼Œå®é™…APIä¸Šä¼ åŠŸèƒ½éœ€è¦æ¨¡å‹ç«¯é…åˆå®ç°
- ä¸Šä¼ æˆåŠŸåï¼Œéœ€è¦è°ƒç”¨ `markAsUploaded()` æ ‡è®°æ•°æ®å·²ä¸Šä¼ ï¼Œé¿å…é‡å¤ä¸Šä¼ 
- æ•°æ®æ”¶é›†èŒƒå›´ï¼šæœ€è¿‘7å¤©çš„è´­ä¹°è®°å½•

